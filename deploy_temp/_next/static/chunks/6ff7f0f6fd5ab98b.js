(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98664,e=>{"use strict";let t=(0,e.i(92511).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>t],98664)},64150,e=>{"use strict";let t=(0,e.i(92511).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>t],64150)},39621,e=>{"use strict";let t=(0,e.i(92511).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],39621)},19583,e=>{"use strict";let t=(0,e.i(92511).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],19583)},95811,e=>{"use strict";let t=(0,e.i(92511).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);e.s(["Heart",()=>t],95811)},14749,e=>{"use strict";let t=(0,e.i(92511).default)("laugh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z",key:"b2q4dd"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);e.s(["Laugh",()=>t],14749)},89369,e=>{"use strict";let t=(0,e.i(92511).default)("thumbs-up",[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]]);e.s(["ThumbsUp",()=>t],89369)},82261,1330,e=>{"use strict";var t=e.i(92511);let s=(0,t.default)("frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);e.s(["Frown",()=>s],82261);let a=(0,t.default)("angry",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["path",{d:"M7.5 8 10 9",key:"olxxln"}],["path",{d:"m14 9 2.5-1",key:"1j6cij"}],["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}]]);e.s(["Angry",()=>a],1330)},15772,e=>{"use strict";var t=e.i(14294),s=e.i(36218),a=e.i(95811),l=e.i(14749),r=e.i(89369),i=e.i(82261),n=e.i(1330),o=e.i(39621);let c=[{type:"like",icon:r.ThumbsUp,color:"text-blue-500",label:"Like"},{type:"love",icon:a.Heart,color:"text-red-500",label:"Love"},{type:"haha",icon:l.Laugh,color:"text-yellow-500",label:"Haha"},{type:"wow",icon:o.Star,color:"text-purple-500",label:"Wow"},{type:"sad",icon:i.Frown,color:"text-blue-400",label:"Sad"},{type:"angry",icon:n.Angry,color:"text-orange-500",label:"Angry"}];function d({onSelect:e,onClose:a}){return(0,t.jsx)("div",{className:"absolute bottom-full left-0 mb-2 z-50",children:(0,t.jsx)(s.motion.div,{initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:10},className:"bg-[#1e293b] border border-[#334155] rounded-full p-1.5 shadow-xl flex items-center gap-0.5 backdrop-blur-xl",onMouseLeave:a,children:c.map((a,l)=>(0,t.jsx)(s.motion.button,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.05*l},whileHover:{scale:1.2,y:-5},onClick:t=>{t.stopPropagation(),e(a.type)},className:"p-1.5 rounded-full hover:bg-white/10 transition-colors relative group tooltip-container",title:a.label,children:(0,t.jsx)(a.icon,{className:`w-[22px] h-[22px] ${a.color}`,fill:"love"===a.type?"currentColor":"none"})},a.type))})})}e.s(["default",()=>d])},4499,33500,e=>{"use strict";var t=e.i(92511);let s=(0,t.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);e.s(["Share2",()=>s],4499);let a=(0,t.default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>a],33500)},74462,e=>{"use strict";let t=(0,e.i(92511).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],74462)},24928,e=>{"use strict";let t=(0,e.i(92511).default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);e.s(["Home",()=>t],24928)},90008,e=>{"use strict";let t=(0,e.i(92511).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],90008)},16187,50861,e=>{"use strict";var t=e.i(92511);let s=(0,t.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>s],16187);let a=(0,t.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["ChevronUp",()=>a],50861)},76674,e=>{"use strict";var t=e.i(14294),s=e.i(30878),a=e.i(68089),l=e.i(7387),r=e.i(72172);let i=(0,e.i(92511).default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var n=e.i(53913),o=e.i(85384),c=e.i(3055);function d(){let[e,d]=(0,s.useState)(""),[u,x]=(0,s.useState)([]),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),b=(0,n.useRouter)();return(0,s.useEffect)(()=>{let t=setTimeout(async()=>{if(e.trim().length<2)return void x([]);h(!0);try{let t=(await o.default.get(`/profile/search?q=${encodeURIComponent(e)}`)).data.map(e=>({type:"user",id:e.id,username:e.username,title:e.displayName||e.username,subtitle:e.email,avatarUrl:e.avatarUrl}));x(t)}catch(e){console.error("Search failed:",e),x([])}finally{h(!1)}},300);return()=>clearTimeout(t)},[e]),(0,t.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#64748b] group-focus-within:text-blue-500 transition-colors"}),(0,t.jsx)("input",{type:"text",value:e,onChange:e=>d(e.target.value),onFocus:()=>f(!0),placeholder:"Search people, posts...",className:"w-full bg-[#1e293b] border-none rounded-full pl-10 pr-10 py-2 text-sm focus:ring-1 focus:ring-blue-500/50 transition-all"}),e&&(0,t.jsx)("button",{onClick:()=>{d(""),x([])},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-[#334155] rounded-full transition-colors",children:(0,t.jsx)(l.X,{className:"w-3 h-3 text-[#64748b]"})})]}),p&&e.trim().length>=2&&(0,t.jsx)("div",{className:"absolute top-full mt-2 w-full bg-[#1e293b] border border-[#334155] rounded-2xl shadow-xl overflow-hidden z-50",children:m?(0,t.jsx)("div",{className:"p-4 text-center text-[#64748b]",children:(0,t.jsx)("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"})}):u.length>0?(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:u.map(e=>(0,t.jsx)("button",{onClick:()=>{"user"===e.type&&b.push(`/profile/${e.username||e.id}`),d(""),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-[#334155] transition-colors text-left",children:"user"===e.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-[#334155] overflow-hidden flex-shrink-0",children:e.avatarUrl?(0,t.jsx)("img",{src:(0,c.fixUrl)(e.avatarUrl),alt:e.title,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600",children:(0,t.jsx)("span",{className:"text-white font-bold",children:e.title[0].toUpperCase()})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-white font-semibold truncate",children:e.title}),e.subtitle&&(0,t.jsx)("p",{className:"text-xs text-[#64748b] truncate",children:e.subtitle})]}),(0,t.jsx)(r.User,{className:"w-4 h-4 text-[#64748b] flex-shrink-0"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)("p",{className:"text-white truncate",children:e.title})})]})},e.id))}):(0,t.jsx)("div",{className:"p-4 text-center text-[#64748b]",children:"No results found"})}),p&&e&&(0,t.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>f(!1)})]})}e.s(["default",()=>d],76674)},62030,39909,e=>{"use strict";var t=e.i(14294),s=e.i(30878),a=e.i(54268),l=e.i(7387),r=e.i(64150),i=e.i(95811),n=e.i(69793),o=e.i(24892),c=e.i(53913),d=e.i(85384),u=e.i(3055);function x(){let[e,x]=(0,s.useState)([]),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(0),{socket:b,isConnected:g}=(0,o.useSocket)(),y=(0,c.useRouter)();(0,s.useEffect)(()=>{if((async()=>{try{if(!localStorage.getItem("token"))return;let e=await d.default.get("/notifications");x(e.data.notifications),f(e.data.unreadCount)}catch(e){console.error("Error fetching notifications:",e)}})(),b)return b.on("notification",e=>{x(t=>[e,...t]),f(e=>e+1)}),()=>{b.off("notification")}},[b]);let v=async e=>{x(t=>t.map(t=>t.id===e.id?{...t,read:!0}:t)),f(e=>Math.max(0,e-1));try{await d.default.put(`/notifications/${e.id}/read`)}catch(e){console.error("Error marking notification as read:",e)}"friend_request"===e.type?y.push("/friends"):y.push(`/profile/${e.from.username}`),h(!1)},j=async()=>{try{await d.default.put("/notifications/read-all"),x(e=>e.map(e=>({...e,read:!0}))),f(0)}catch(e){console.error("Error marking all as read:",e)}};return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>h(!m),className:"p-2.5 rounded-full hover:bg-[#1e293b] transition-colors relative",children:[(0,t.jsx)(a.Bell,{className:"w-6 h-6"}),p>0&&(0,t.jsx)("span",{className:"absolute top-2 right-2 min-w-[18px] h-[18px] bg-blue-600 text-white text-xs font-bold rounded-full flex items-center justify-center px-1",children:p>9?"9+":p})]}),m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-[#1e293b] border border-[#334155] rounded-2xl shadow-xl overflow-hidden z-50",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-[#334155] flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"font-bold text-white",children:"Notifications"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[p>0&&(0,t.jsx)("button",{onClick:j,className:"text-xs text-blue-500 hover:text-blue-400 font-medium",children:"Mark all read"}),(0,t.jsx)("button",{onClick:()=>h(!1),className:"p-1 hover:bg-[#334155] rounded-full transition-colors",children:(0,t.jsx)(l.X,{className:"w-4 h-4 text-[#64748b]"})})]})]}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:e.length>0?e.map(e=>(0,t.jsxs)("button",{onClick:()=>v(e),className:`w-full flex items-start gap-3 p-4 hover:bg-[#334155] transition-colors text-left ${!e.read?"bg-blue-500/5":""}`,children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-[#334155] overflow-hidden flex-shrink-0",children:e.from.avatarUrl?(0,t.jsx)("img",{src:(0,u.fixUrl)(e.from.avatarUrl),alt:e.from.displayName||e.from.username||"",className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600",children:(0,t.jsx)("span",{className:"text-white font-bold",children:(e.from.displayName||e.from.username)?.[0]?.toUpperCase()})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("p",{className:"text-sm text-white",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.from.displayName||e.from.username})," ",e.message]}),(0,t.jsx)("p",{className:"text-xs text-[#64748b] mt-1",children:new Date(e.createdAt).toLocaleString()})]}),(0,t.jsx)("div",{className:"flex-shrink-0",children:(e=>{switch(e){case"friend_request":return(0,t.jsx)(r.UserPlus,{className:"w-5 h-5 text-blue-500"});case"like":return(0,t.jsx)(i.Heart,{className:"w-5 h-5 text-red-500"});case"comment":return(0,t.jsx)(n.MessageCircle,{className:"w-5 h-5 text-green-500"});default:return(0,t.jsx)(a.Bell,{className:"w-5 h-5 text-[#64748b]"})}})(e.type)})]},e.id)):(0,t.jsxs)("div",{className:"p-8 text-center text-[#64748b]",children:[(0,t.jsx)(a.Bell,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No notifications yet"})]})})]}),(0,t.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>h(!1)})]})]})}e.s(["default",()=>x],62030);var m=e.i(92511);let h=(0,m.default)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),p=(0,m.default)("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]);var f=e.i(47548);function b(){let{theme:e,toggleTheme:s}=(0,f.useTheme)();return(0,t.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-[#1e293b] dark:hover:bg-[#1e293b] transition-colors","aria-label":"Toggle theme",children:"dark"===e?(0,t.jsx)(h,{className:"w-5 h-5 text-yellow-500"}):(0,t.jsx)(p,{className:"w-5 h-5 text-slate-700"})})}e.s(["default",()=>b],39909)},94188,51988,e=>{"use strict";var t=e.i(92511);let s=(0,t.default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>s],94188);let a=(0,t.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);e.s(["Square",()=>a],51988)},59573,8252,26503,e=>{"use strict";var t=e.i(92511);let s=(0,t.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);e.s(["Flag",()=>s],59573);var a=e.i(14294),l=e.i(30878);let r=(0,t.default)("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]);var i=e.i(51988),n=e.i(94188),o=e.i(4781);function c({onRecordingComplete:e,onCancel:t}){let[s,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(0),[x,m]=(0,l.useState)(null),[h,p]=(0,l.useState)(null),[f,b]=(0,l.useState)(!1),g=(0,l.useRef)(null),y=(0,l.useRef)([]),v=(0,l.useRef)(null),j=(0,l.useRef)(null),w=async()=>{try{let t=await navigator.mediaDevices.getUserMedia({audio:!0});g.current=new MediaRecorder(t),y.current=[],g.current.ondataavailable=e=>{e.data.size>0&&y.current.push(e.data)},g.current.onstop=()=>{let s=new Blob(y.current,{type:"audio/webm"});p(s);let a=URL.createObjectURL(s);m(a),e(s),t.getTracks().forEach(e=>e.stop())},g.current.start(),c(!0),v.current=setInterval(()=>{u(e=>e+1)},1e3)}catch(e){console.error("Error accessing microphone:",e),alert("Cannot access microphone. Please allow permissions."),t()}},N=e=>{let t=Math.floor(e/60);return`${t}:${(e%60).toString().padStart(2,"0")}`};return((0,l.useEffect)(()=>()=>{v.current&&clearInterval(v.current),x&&URL.revokeObjectURL(x)},[x]),x)?(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-[#334155]/50 px-3 py-1.5 rounded-full border border-blue-500/30",children:[(0,a.jsx)("button",{onClick:()=>{j.current&&(j.current.play(),b(!0))},className:"p-1.5 bg-blue-500 rounded-full text-white hover:bg-blue-600 transition-colors",children:(0,a.jsx)(n.Play,{className:"w-3 h-3 fill-current"})}),(0,a.jsx)("div",{className:"flex-1 min-w-[60px]",children:(0,a.jsx)("div",{className:"h-1 bg-white/20 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-blue-500 w-full animate-pulse"})})}),(0,a.jsx)("span",{className:"text-xs text-blue-200 font-mono",children:N(d)}),(0,a.jsx)("button",{onClick:()=>{m(null),p(null),u(0)},className:"p-1 text-red-400 hover:bg-red-500/10 rounded-full transition-colors",children:(0,a.jsx)(o.Trash2,{className:"w-4 h-4"})}),(0,a.jsx)("audio",{ref:j,src:x,onEnded:()=>b(!1),className:"hidden"})]}):(0,a.jsx)("div",{className:"flex items-center gap-2",children:s?(0,a.jsxs)("div",{className:"flex items-center gap-3 bg-red-500/10 px-3 py-1.5 rounded-full border border-red-500/20 animate-in fade-in duration-200",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-mono text-red-400 min-w-[35px]",children:N(d)}),(0,a.jsx)("button",{onClick:()=>{g.current&&s&&(g.current.stop(),c(!1),v.current&&clearInterval(v.current))},className:"p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:(0,a.jsx)(i.Square,{className:"w-3 h-3 fill-current"})})]}):(0,a.jsxs)("button",{onClick:w,className:"p-2 text-red-500 hover:bg-red-500/10 rounded-full transition-colors relative group",title:"Record Voice Comment",children:[(0,a.jsx)(r,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-black text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"Record Voice"})]})})}e.s(["default",()=>c],8252);var d=e.i(36218);let u=[{id:"1",url:"https://cdn-icons-png.flaticon.com/512/742/742751.png",name:"Smile"},{id:"2",url:"https://cdn-icons-png.flaticon.com/512/742/742752.png",name:"Laugh"},{id:"3",url:"https://cdn-icons-png.flaticon.com/512/742/742921.png",name:"Love"},{id:"4",url:"https://cdn-icons-png.flaticon.com/512/742/742760.png",name:"Cool"},{id:"5",url:"https://cdn-icons-png.flaticon.com/512/742/742822.png",name:"Wink"},{id:"6",url:"https://cdn-icons-png.flaticon.com/512/742/742939.png",name:"Surprise"},{id:"7",url:"https://cdn-icons-png.flaticon.com/512/742/742750.png",name:"Sad"},{id:"8",url:"https://cdn-icons-png.flaticon.com/512/742/742785.png",name:"Angry"},{id:"9",url:"https://cdn-icons-png.flaticon.com/512/9205/9205047.png",name:"Party"},{id:"10",url:"https://cdn-icons-png.flaticon.com/512/9205/9205260.png",name:"Ghost"},{id:"11",url:"https://cdn-icons-png.flaticon.com/512/9205/9205089.png",name:"Fire"},{id:"12",url:"https://cdn-icons-png.flaticon.com/512/9205/9205423.png",name:"Star"}];function x({onSelect:e,onClose:t}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:t}),(0,a.jsxs)(d.motion.div,{initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},className:"absolute bottom-14 right-0 bg-[#1e293b] border border-[#334155] rounded-2xl shadow-xl w-64 p-3 z-50 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2 pb-2 border-b border-[#334155]",children:[(0,a.jsx)("span",{className:"text-xs font-bold text-[#94a3b8]",children:"Stickers"}),(0,a.jsxs)("button",{onClick:t,className:"text-[#64748b] hover:text-white",children:[(0,a.jsx)("span",{className:"sr-only",children:"Close"}),"Ã—"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2 h-48 overflow-y-auto pr-1",children:u.map(s=>(0,a.jsx)("button",{onClick:()=>{e(s.url),t()},className:"aspect-square p-1.5 hover:bg-[#334155] rounded-xl transition-colors flex items-center justify-center group",children:(0,a.jsx)("img",{src:s.url,alt:s.name,className:"w-full h-full object-contain group-hover:scale-110 transition-transform",onError:e=>{e.currentTarget.src=`https://ui-avatars.com/api/?name=${s.name}&background=random`}})},s.id))})]})]})}e.s(["default",()=>x],26503)},56011,e=>{"use strict";var t=e.i(14294),s=e.i(30878),a=e.i(7387),l=e.i(99913),r=e.i(61957),i=e.i(95811),n=e.i(69793),o=e.i(4499),c=e.i(33500),d=e.i(98664),u=e.i(4781),x=e.i(74462),m=e.i(19583),h=e.i(94188),p=e.i(51988),f=e.i(11355),b=e.i(89369),g=e.i(14749),y=e.i(82261),v=e.i(1330),j=e.i(39621),w=e.i(59573),N=e.i(85384),k=e.i(36218),S=e.i(94654),C=e.i(4561),M=e.i(8252),U=e.i(24892),F=e.i(26503),z=e.i(15772),A=e.i(3055);let E=e=>{let t=new Date,s=new Date(e),a=Math.floor((t.getTime()-s.getTime())/1e3);return a<60?"Just now":a<3600?`${Math.floor(a/60)}m`:a<86400?`${Math.floor(a/3600)}h`:a<604800?`${Math.floor(a/86400)}d`:s.toLocaleDateString()},$=({src:e})=>{let a=(0,s.useRef)(null),[l,r]=(0,s.useState)(!1);return(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2 bg-[#334155]/40 p-2 pr-4 rounded-xl w-fit border border-[#334155]/30",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{a.current&&(l?a.current.pause():a.current.play())},className:"w-8 h-8 flex-shrink-0 flex items-center justify-center bg-blue-500 rounded-full text-white hover:bg-blue-600 transition-colors shadow-blue-500/20 shadow-lg",children:l?(0,t.jsx)(p.Square,{className:"w-3 h-3 fill-current"}):(0,t.jsx)(h.Play,{className:"w-3.5 h-3.5 fill-current ml-0.5"})}),(0,t.jsxs)("div",{className:"flex flex-col min-w-[100px]",children:[(0,t.jsx)("span",{className:"text-[9px] text-blue-300 font-bold uppercase tracking-wider mb-1",children:"Voice Message"}),(0,t.jsx)("div",{className:"h-1.5 w-full bg-white/10 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:`h-full bg-blue-400 rounded-full transition-all duration-200 ${l?"w-full animate-pulse":"w-1/3"}`})})]}),(0,t.jsx)("audio",{ref:a,src:e,onPlay:()=>r(!0),onPause:()=>r(!1),onEnded:()=>r(!1),className:"hidden"})]})};function L({comment:e,currentUserId:a,onUpdate:l,onDelete:i,onReply:n,replies:o=[]}){let[x,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[f,b]=(0,s.useState)(e.content||""),[g,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[w,C]=(0,s.useState)(!1),[M,U]=(0,s.useState)(0),[F,z]=(0,s.useState)(!1),P=(0,s.useRef)(null);(0,s.useEffect)(()=>{h&&P.current&&(P.current.style.height="auto",P.current.style.height=P.current.scrollHeight+"px")},[f,h]);let R=a===e.user?.id,q=async()=>{if(f.trim()||e.stickerUrl||e.audioUrl){j(!0);try{await N.default.put(`/comments/${e.id}`,{content:f}),e.content=f,p(!1),l&&l(e.id,f)}catch(e){console.error("Failed to update comment:",e),alert("Failed to update comment")}finally{j(!1)}}},H=async()=>{if(confirm("Are you sure you want to delete this comment?"))try{await N.default.delete(`/comments/${e.id}`),i&&i(e.id)}catch(e){console.error("Failed to delete comment:",e),alert("Failed to delete comment")}};return(0,t.jsxs)("div",{className:"flex flex-col w-full gap-1",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2 group relative w-full",children:[(0,t.jsx)("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex-shrink-0 overflow-hidden ring-2 ring-blue-500/10 mt-0.5",children:e.user?.avatarUrl?(0,t.jsx)("img",{src:(0,A.fixUrl)(e.user.avatarUrl),alt:e.user?.displayName||e.user?.username||"",className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-700",children:(0,t.jsx)("span",{className:"text-white text-[10px] font-bold",children:(e.user?.displayName||e.user?.username)?.[0]?.toUpperCase()||"U"})})}),(0,t.jsxs)("div",{className:"flex-1 flex items-start gap-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("div",{className:"bg-[#1e293b]/60 backdrop-blur-sm rounded-2xl px-3 py-1.5 border border-[#334155]/20 hover:border-[#475569]/30 transition-all w-fit max-w-[214px]",children:[(0,t.jsx)("div",{className:"flex items-center gap-1.5 mb-0.5",children:(0,t.jsx)("p",{className:"text-xs font-bold text-white",children:e.user?.displayName||e.user?.username||"User"})}),h?(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("textarea",{ref:P,value:f,onChange:e=>b(e.target.value),className:"w-full bg-transparent border-none p-0 text-[13px] text-[#e2e8f0] resize-none focus:outline-none focus:ring-0 overflow-hidden min-h-[20px] leading-relaxed",placeholder:"Edit your comment...",autoFocus:!0,rows:1,maxLength:1e4}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,t.jsx)("button",{onClick:()=>{p(!1),b(e.content||"")},className:"text-[10px] font-medium text-[#94a3b8] hover:text-white transition-colors",children:"Cancel"}),(0,t.jsxs)("button",{onClick:q,disabled:v,className:"px-2 py-0.5 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 text-[10px] font-bold text-white rounded shadow-sm transition-all flex items-center gap-1",children:[v?(0,t.jsx)(r.Loader2,{className:"w-2.5 h-2.5 animate-spin"}):null,"Save"]})]})]}):(0,t.jsxs)(t.Fragment,{children:[e.content&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("p",{className:`text-[13px] text-[#e2e8f0] leading-relaxed break-words whitespace-pre-wrap ${!x&&"line-clamp-3"}`,children:e.content}),e.content.length>120&&(0,t.jsx)("button",{onClick:()=>m(!x),className:"text-[11px] font-bold text-blue-400 hover:text-blue-300 transition-colors mt-1 block hover:underline",children:x?"See Less":"See More"})]}),e.stickerUrl&&(0,t.jsx)("img",{src:(0,A.fixUrl)(e.stickerUrl),alt:"Sticker",className:"w-16 h-16 object-contain mt-1.5"}),e.audioUrl&&(0,t.jsx)("div",{className:"mt-1.5",children:(0,t.jsx)($,{src:(0,A.fixUrl)(e.audioUrl)||""})})]})]}),!h&&(0,t.jsxs)("div",{className:"flex items-center gap-3 px-2",children:[(0,t.jsxs)("button",{onClick:()=>{C(!w),U(e=>w?e-1:e+1)},className:`text-[11px] font-bold transition-colors ${w?"text-blue-500":"text-[#64748b] hover:text-blue-400"}`,children:["Like",M>0&&` \xb7 ${M}`]}),(0,t.jsx)("button",{onClick:()=>n&&n(e.user?.username||"User",e.id),className:"text-[11px] font-bold text-[#64748b] hover:text-blue-400 transition-colors",children:"Reply"}),(0,t.jsx)("span",{className:"text-[10px] text-[#64748b]",children:E(e.createdAt)})]})]}),R&&!h&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:()=>y(!g),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-white/10 rounded-full transition-all text-[#64748b] hover:text-white",children:(0,t.jsx)(c.MoreHorizontal,{className:"w-3.5 h-3.5"})}),(0,t.jsx)(S.AnimatePresence,{children:g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.motion.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-0 mt-1 w-32 bg-[#1e293b]/95 backdrop-blur-xl rounded-xl shadow-2xl overflow-hidden z-[150] border border-[#334155]/50",children:(0,t.jsxs)("div",{className:"py-0.5",children:[(0,t.jsxs)("button",{onClick:()=>{y(!1),p(!0)},className:"w-full flex items-center gap-2 px-3 py-1.5 text-xs text-white hover:bg-[#334155]/50 transition-colors group/edit font-semibold",children:[(0,t.jsx)(d.Edit2,{className:"w-3 h-3 text-blue-400"}),"Edit"]}),(0,t.jsxs)("button",{onClick:()=>{y(!1),H()},className:"w-full flex items-center gap-2 px-3 py-1.5 text-xs text-red-500 hover:bg-red-500/10 transition-colors group/delete font-semibold",children:[(0,t.jsx)(u.Trash2,{className:"w-3 h-3 text-red-400"}),"Delete"]})]})}),(0,t.jsx)("div",{className:"fixed inset-0 z-[140]",onClick:()=>y(!1)})]})})]})]})]}),o.length>0&&(0,t.jsxs)("div",{className:"pl-11 mt-2 space-y-3 relative",children:[(0,t.jsx)("div",{className:"absolute left-[1.35rem] top-0 bottom-0 w-0.5 bg-[#334155]/20 rounded-full"}),o.map(e=>(0,t.jsx)(L,{comment:e,currentUserId:a,onUpdate:l,onDelete:i,onReply:n,replies:[]},e.id))]})]})}function P({isOpen:e,onClose:h,post:p,onUpdate:$,onDelete:P,currentUserId:R}){let[q,H]=(0,s.useState)([]),[I,T]=(0,s.useState)(""),[D,O]=(0,s.useState)(!1),[_,W]=(0,s.useState)(!1),[X,B]=(0,s.useState)(!1),[V,G]=(0,s.useState)(p._count?.likes||0),[K,J]=(0,s.useState)(!1),[Y,Z]=(0,s.useState)(p.content||""),[Q,ee]=(0,s.useState)(!1),[et,es]=(0,s.useState)(!1),[ea,el]=(0,s.useState)(null),[er,ei]=(0,s.useState)(!1),[en,eo]=(0,s.useState)(null),[ec,ed]=(0,s.useState)(!1),[eu,ex]=(0,s.useState)(null),[em,eh]=(0,s.useState)(null),[ep,ef]=(0,s.useState)(null),{socket:eb}=(0,U.useSocket)(),eg=(0,s.useRef)(null),ey=(0,s.useRef)(null);(0,s.useEffect)(()=>{e&&K&&(()=>{let e=eg.current;if(!e)return;e.style.height="auto";let t=Math.min(Math.max(e.scrollHeight,40),480);e.style.height=`${t}px`,e.style.overflowY=t>=480?"auto":"hidden"})()},[e,K,Y]);let ev=R===p.author.id,ej=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(e&&p&&p.author&&p.id){let t=`/${p.author.username}/${p.id}`;window.location.pathname!==t&&(ej.current=window.location.pathname+window.location.search,window.history.pushState({postModal:!0},"",t));let s=()=>{e&&h()};return window.addEventListener("popstate",s),()=>{window.removeEventListener("popstate",s),ej.current&&window.location.pathname===t&&window.history.pushState(null,"",ej.current)}}},[e,p,h]),(0,s.useEffect)(()=>{if(!e)return;let t=e=>{"Escape"===e.key&&h()};document.addEventListener("keydown",t);let s=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",t),document.body.style.overflow=s}},[e,h]),(0,s.useEffect)(()=>{if(e&&(ek(),Z(p.content||""),eN(),ew(),T(""),eo(null),ex(null),ed(!1),ef(null),eb))return eb.emit("join_post",p.id),eb.on("new_comment",e=>{e.postId===p.id&&H(t=>t.find(t=>t.id===e.id)?t:[...t,e])}),eb.on("comment_deleted",({commentId:e})=>{H(t=>t.filter(t=>t.id!==e&&t.parentId!==e))}),eb.on("comment_updated",({commentId:e,content:t})=>{H(s=>s.map(s=>s.id===e?{...s,content:t}:s))}),()=>{eb.emit("leave_post",p.id),eb.off("new_comment"),eb.off("comment_deleted"),eb.off("comment_updated")}},[e,p,eb]);let ew=async()=>{try{let e=await N.default.get("/auth/me");eh(e.data)}catch(e){console.error("Failed to fetch current user:",e)}},eN=async()=>{},ek=async()=>{O(!0);try{let e=await N.default.get(`/posts/${p.id}/comments`);H(e.data)}catch(e){console.error("Failed to fetch comments:",e)}finally{O(!1)}},eS=async e=>{ea===e?(el(null),G(e=>Math.max(0,e-1))):(el(e),ea||G(e=>e+1)),ei(!1);try{await N.default.post(`/posts/${p.id}/like`,{type:e})}catch(e){console.error("Failed to react:",e)}},eC=(e,t)=>{ef({id:t,username:e}),ey.current?.focus()},eM=async e=>{if(e.preventDefault(),I.trim()||en||eu){W(!0);try{let e=new FormData;I.trim()&&e.append("content",I),en&&e.append("audio",en,"voice-comment.webm"),eu&&e.append("stickerUrl",eu),ep&&e.append("parentId",ep.id);let t=await N.default.post(`/posts/${p.id}/comment`,e,{headers:{"Content-Type":"multipart/form-data"}});H(e=>e.find(e=>e.id===t.data.id)?e:[...e,t.data]),T(""),eo(null),ex(null),ed(!1),ef(null),ey.current&&(ey.current.style.height="24px")}catch(e){console.error("Failed to add comment:",e)}finally{W(!1)}}},eU=async()=>{if(Y.trim()){ee(!0);try{await N.default.put(`/posts/${p.id}`,{content:Y}),p.content=Y,J(!1),$&&$(p)}catch(e){console.error("Failed to update post:",e),alert("Failed to update post")}finally{ee(!1)}}},eF=async()=>{if(confirm("Are you sure you want to delete this post?"))try{await N.default.delete(`/posts/${p.id}`),P&&P(p.id),h()}catch(e){console.error("Failed to delete post:",e),alert("Failed to delete post")}};return e?(0,t.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm sm:p-4",onClick:h,role:"presentation",children:(0,t.jsxs)("div",{onClick:e=>e.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Post details",className:"bg-[#1e293b] sm:border border-none border-[#334155]/60 sm:rounded-3xl rounded-none w-full max-w-lg h-full sm:h-auto sm:max-h-[80vh] flex flex-col overflow-hidden shadow-2xl relative",children:[(0,t.jsxs)("div",{className:"sm:hidden sticky top-0 z-[50] bg-[#1e293b] px-4 h-[44px] flex items-center justify-between border-none",children:[(0,t.jsx)("h2",{className:"text-[15px] font-bold text-white tracking-wide",children:"Post"}),(0,t.jsx)("button",{onClick:h,className:"w-8 h-8 flex items-center justify-center bg-[#334155]/50 hover:bg-[#475569]/70 rounded-full text-[#94a3b8] hover:text-white transition-all duration-200",children:(0,t.jsx)(a.X,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[(0,t.jsxs)("div",{className:"sticky top-0 z-[40] bg-[#1e293b] px-4 sm:py-3 pt-8 pb-3 mt-0 flex items-center justify-between border-b border-[#334155]/10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(C.default,{href:`/profile/${p.author.username}`,className:"relative flex-shrink-0 group",onClick:h,children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-[#334155] bg-cover bg-center ring-2 ring-blue-500/20 group-hover:ring-blue-500/40 transition-all duration-300",style:{backgroundImage:p.author.avatarUrl?`url(${(0,A.fixUrl)(p.author.avatarUrl)})`:void 0}}),(0,t.jsx)("div",{className:"absolute bottom-0.5 right-0.5 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-[#1e293b]"})]}),(0,t.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,t.jsx)(C.default,{href:`/profile/${p.author.username}`,className:"text-white font-bold text-[15px] hover:underline decoration-blue-500/50 underline-offset-2 leading-tight",onClick:h,children:p.author.displayName||p.author.username}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-[11px] font-medium text-[#64748b] mt-0.5",children:[(0,t.jsx)(x.Clock,{className:"w-3 h-3"}),(0,t.jsx)("p",{children:E(p.createdAt)}),(0,t.jsx)("span",{className:"w-1 h-1 rounded-full bg-[#334155]"}),(0,t.jsx)("span",{className:"text-blue-500/80",children:"Public"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:()=>es(!et),className:`w-8 h-8 flex items-center justify-center rounded-full transition-all ${et?"bg-[#334155] text-white":"hover:bg-[#334155]/50 text-[#94a3b8] hover:text-white"}`,children:(0,t.jsx)(c.MoreHorizontal,{className:"w-5 h-5"})}),(0,t.jsx)(S.AnimatePresence,{children:et&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.motion.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-0 mt-1 w-48 bg-[#1e293b]/98 backdrop-blur-2xl border border-[#334155]/70 rounded-xl shadow-2xl overflow-hidden z-[110] border border-[#334155]/50",children:(0,t.jsx)("div",{className:"py-1",children:ev?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>{es(!1),J(!0)},className:"w-full flex items-center gap-3 px-4 py-2.5 hover:bg-[#334155]/50 text-white transition-colors text-sm font-medium group",children:[(0,t.jsx)(d.Edit2,{className:"w-4 h-4 text-blue-400"}),"Edit Post"]}),(0,t.jsxs)("button",{onClick:()=>{es(!1),eF()},className:"w-full flex items-center gap-3 px-4 py-2.5 hover:bg-red-500/10 text-red-500 transition-colors text-sm font-medium group",children:[(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,t.jsx)(u.Trash2,{className:"w-4 h-4 text-red-400"})}),"Delete Post"]})]}):(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 px-4 py-2.5 hover:bg-yellow-500/10 text-yellow-500 transition-colors text-sm font-medium group",children:[(0,t.jsx)(w.Flag,{className:"w-4 h-4"}),"Report Post"]})})}),(0,t.jsx)("div",{className:"fixed inset-0 z-[105]",onClick:()=>es(!1)})]})})]}),(0,t.jsx)("button",{onClick:h,className:"hidden sm:flex w-8 h-8 items-center justify-center bg-[#334155]/50 hover:bg-[#475569]/70 rounded-full text-[#94a3b8] hover:text-white transition-all duration-200",children:(0,t.jsx)(a.X,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"px-4 pt-3 pb-0 bg-[#0f172a]/30",children:[(0,t.jsx)("div",{className:K?"mb-1":"mb-3",children:K?(0,t.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-200",children:(0,t.jsx)("textarea",{ref:eg,value:Y,onChange:e=>Z(e.target.value),className:"w-full bg-transparent border-none outline-none focus:ring-0 text-white placeholder-[#64748b] resize-none py-1 text-[15px] leading-relaxed overflow-y-auto [&::-webkit-scrollbar]:hidden",style:{minHeight:40,maxHeight:480},rows:1,placeholder:"Edit your post...",autoFocus:!0,maxLength:65e3})}):(0,t.jsx)(t.Fragment,{children:p.content&&(0,t.jsx)("p",{className:"text-[#e2e8f0] text-[15px] leading-relaxed whitespace-pre-wrap",children:p.content})})}),p.imageUrl&&(0,t.jsx)("div",{className:"rounded-lg overflow-hidden bg-black mb-3 border border-[#334155]/50",children:(0,t.jsx)("img",{src:(0,A.fixUrl)(p.imageUrl),alt:"Post",className:"w-full h-auto max-h-[400px] object-contain mx-auto"})}),K&&(0,t.jsxs)("div",{className:"flex justify-center gap-3 py-4 border-t border-[#334155]/40 mt-2",children:[(0,t.jsx)("button",{onClick:()=>{J(!1),Z(p.content||"")},className:"px-6 py-2.5 text-sm font-semibold text-[#94a3b8] hover:text-white transition-colors bg-[#334155]/30 hover:bg-[#334155]/50 rounded-xl border border-[#334155]/50 min-w-[120px]",children:"Cancel"}),(0,t.jsx)("button",{onClick:eU,disabled:Q||!Y.trim(),className:"px-8 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 disabled:opacity-50 text-sm font-bold text-white rounded-xl transition-all shadow-lg shadow-blue-500/20 active:scale-95 flex items-center justify-center gap-2 min-w-[160px]",children:Q?(0,t.jsx)(r.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Check,{className:"w-4 h-4"})," ",(0,t.jsx)("span",{children:"Save Changes"})]})})]}),!K&&(0,t.jsxs)("div",{className:"px-4 h-[50px] flex items-center justify-between border-t border-[#334155]/30",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"relative",onMouseEnter:()=>ei(!0),onMouseLeave:()=>ei(!1),children:[(0,t.jsx)(S.AnimatePresence,{children:er&&(0,t.jsx)(z.default,{onSelect:eS,onClose:()=>ei(!1)})}),(0,t.jsxs)(k.motion.button,{whileTap:{scale:.9},onClick:()=>eS(ea||"like"),className:"flex items-center gap-1.5 group/like relative z-10 translate-y-[1px]",children:[(0,t.jsx)("div",{className:"p-2 rounded-full group-hover/like:bg-white/5 transition-colors",children:(e=>{switch(e){case"love":return(0,t.jsx)(i.Heart,{className:"w-4 h-4 text-red-500 fill-red-500"});case"haha":return(0,t.jsx)(g.Laugh,{className:"w-4 h-4 text-yellow-500"});case"wow":return(0,t.jsx)(j.Star,{className:"w-4 h-4 text-purple-500"});case"sad":return(0,t.jsx)(y.Frown,{className:"w-4 h-4 text-blue-400"});case"angry":return(0,t.jsx)(v.Angry,{className:"w-4 h-4 text-orange-500"});case"like":return(0,t.jsx)(b.ThumbsUp,{className:"w-4 h-4 text-blue-500 fill-blue-500"});default:return(0,t.jsx)(i.Heart,{className:"w-4 h-4 text-[#64748b]"})}})(ea)}),(0,t.jsx)("span",{className:`text-xs font-bold transition-colors ${ea?"text-blue-500":"text-[#64748b] group-hover/like:text-blue-500"}`,children:V})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 group/comment translate-y-[1px]",children:[(0,t.jsx)("div",{className:"p-2 rounded-full group-hover/comment:bg-blue-500/10 transition-colors",children:(0,t.jsx)(n.MessageCircle,{className:"w-4 h-4 text-[#64748b] group-hover/comment:text-blue-500 transition-colors"})}),(0,t.jsx)("span",{className:"text-xs font-bold text-[#64748b] group-hover/comment:text-blue-500 transition-colors",children:q.length})]})]}),(0,t.jsx)(k.motion.button,{whileTap:{scale:.9},className:"p-2 rounded-full hover:bg-white/5 transition-colors text-[#64748b] hover:text-white group/share translate-y-[1px]",children:(0,t.jsx)(o.Share2,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{className:"border-t border-[#334155]/30 px-4 py-2 bg-[#0f172a]/20",children:(0,t.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0 bg-[#0f172a]/20 custom-scrollbar",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,t.jsx)("div",{className:"p-4 space-y-4",children:q.length>0?(0,t.jsx)("div",{className:"space-y-3.5 pb-4",children:q.filter(e=>!e.parentId).map(e=>(0,t.jsx)(L,{comment:e,currentUserId:R,onUpdate:(e,t)=>H(s=>s.map(s=>s.id===e?{...s,content:t}:s)),onDelete:e=>H(t=>t.filter(t=>t.id!==e)),onReply:eC,replies:q.filter(t=>t.parentId===e.id)},e.id))}):(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("p",{className:"text-[#64748b] text-xs",children:"No comments yet"}),(0,t.jsx)("p",{className:"text-[11px] text-[#475569] mt-0.5",children:"Start the conversation!"})]})})})})]}),(0,t.jsx)("div",{className:"flex-none px-3 py-2 bg-[#0f172a]/20 z-10 w-full",children:R?(0,t.jsxs)("form",{onSubmit:eM,className:"flex gap-2 items-end w-full",children:[(0,t.jsx)("div",{className:"flex-1 bg-[#1e293b]/40 hover:bg-[#1e293b]/60 transition-colors rounded-2xl px-3 py-2 min-h-[44px] flex items-center",children:eu?(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-[#1e293b] px-3 py-1 rounded-xl border border-[#334155] w-fit",children:[(0,t.jsx)("img",{src:(0,A.fixUrl)(eu),alt:"Selected",className:"w-8 h-8 object-contain"}),(0,t.jsx)("button",{type:"button",onClick:()=>ex(null),className:"p-1 hover:bg-white/10 rounded-full text-[#94a3b8]",children:(0,t.jsx)(a.X,{className:"w-3 h-3"})})]}):ep?(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-[#1e293b] px-3 py-1 rounded-xl border border-[#334155] w-fit mb-1",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-[10px] text-[#94a3b8] uppercase tracking-wider font-bold",children:"Replying to"}),(0,t.jsxs)("span",{className:"text-xs text-blue-400 font-bold",children:["@",ep.username]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>ef(null),className:"p-1 hover:bg-white/10 rounded-full text-[#94a3b8] ml-2",children:(0,t.jsx)(a.X,{className:"w-3 h-3"})})]}):en?(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-blue-500/10 px-3 py-1 rounded-full border border-blue-500/20 w-fit",children:[(0,t.jsx)("span",{className:"text-xs text-blue-300 font-medium whitespace-nowrap",children:"Voice recording ready"}),(0,t.jsx)("button",{type:"button",onClick:()=>eo(null),className:"p-1 hover:bg-white/10 rounded-full text-blue-200",children:(0,t.jsx)(a.X,{className:"w-3 h-3"})})]}):(0,t.jsx)("textarea",{ref:ey,value:I,onChange:e=>{T(e.target.value);let t=ey.current;if(t){t.style.height="24px";let e=Math.min(t.scrollHeight,120);t.style.height=(e>24?e:24)+"px",t.style.overflowY=t.scrollHeight>120?"auto":"hidden"}},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eM(e))},placeholder:"Write a comment...",rows:1,className:"w-full bg-transparent border-none outline-none text-[15px] text-white placeholder-[#64748b] resize-none overflow-hidden min-h-[24px] py-0 break-words whitespace-pre-wrap",style:{height:"auto"},maxLength:1e4})}),(0,t.jsxs)("div",{className:"flex items-center gap-1 shrink-0 pb-1",children:[!en&&!eu&&!ep&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{type:"button",onClick:()=>ed(!ec),className:"p-2 text-[#94a3b8] hover:bg-[#334155] hover:text-blue-400 rounded-full transition-all",children:(0,t.jsx)(f.Smile,{className:"w-5 h-5"})}),(0,t.jsx)(S.AnimatePresence,{children:ec&&(0,t.jsx)("div",{className:"absolute bottom-full right-0 mb-2 z-50",children:(0,t.jsx)(F.default,{onSelect:e=>ex(e),onClose:()=>ed(!1)})})})]}),(0,t.jsx)(M.default,{onRecordingComplete:e=>eo(e),onCancel:()=>eo(null)})]}),(0,t.jsx)("button",{type:"submit",disabled:_||!I.trim()&&!en&&!eu,className:"p-2.5 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 text-white rounded-full transition-all shadow-lg shadow-blue-500/20 active:scale-95 flex-shrink-0",children:_?(0,t.jsx)(r.Loader2,{className:"w-5 h-5 animate-spin"}):(0,t.jsx)(l.Send,{className:"w-5 h-5"})})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center py-2 px-4 bg-[#1e293b]/40 rounded-xl border border-[#334155]/50",children:(0,t.jsx)("p",{className:"text-sm text-[#94a3b8]",children:"Please login to join the conversation"})})})]})}):null}e.s(["default",()=>P])},38100,e=>{"use strict";let t=(0,e.i(92511).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>t],38100)},91234,e=>{"use strict";let t=(0,e.i(92511).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],91234)},5469,e=>{"use strict";var t=e.i(14294),s=e.i(30878),a=e.i(4561),l=e.i(53913),r=e.i(24928),i=e.i(69793),n=e.i(90008),o=e.i(72172),c=e.i(16187),d=e.i(62621),u=e.i(30994),x=e.i(50861),m=e.i(76674),h=e.i(62030),p=e.i(39909),f=e.i(85384),b=e.i(59796),g=e.i(3055),y=e.i(56011),v=e.i(36218),j=e.i(94654),w=e.i(7387),N=e.i(38445),k=e.i(16248),S=e.i(85877),C=e.i(68474),M=e.i(38100),U=e.i(51934),F=e.i(91234);let z=(0,e.i(92511).default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var A=e.i(98521),E=e.i(78497);function $(...e){return(0,E.twMerge)((0,A.clsx)(e))}function L({isOpen:e,onClose:a,initialMode:l="login"}){let[r,i]=(0,s.useState)(l),[n,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(""),[x,m]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[g,y]=(0,s.useState)("other"),[A,E]=(0,s.useState)(""),[L,P]=(0,s.useState)(!1),[R,q]=(0,s.useState)(""),[H,I]=(0,s.useState)(!1),[T,D]=(0,s.useState)(!1),{login:O}=(0,b.useAuth)();(0,s.useEffect)(()=>{let e=()=>D(window.innerWidth<640);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{e&&i(l)},[e,l]),(0,s.useEffect)(()=>{q("")},[r]);let _=async e=>{e.preventDefault(),P(!0),q("");try{if("login"===r){let{token:e,user:t}=(await f.default.post("/auth/login",{email:n,password:d})).data;O(e,t),a()}else await f.default.post("/auth/register",{displayName:x,email:n,password:d,dob:h,gender:g,phoneNumber:A}),i("login"),q("Registration successful! Please login.")}catch(e){q(e.response?.data?.message||"Authentication failed")}finally{P(!1)}};return(0,t.jsx)(j.AnimatePresence,{children:e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center overflow-hidden",children:[(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,className:$("absolute inset-0 transition-colors duration-500",T?"bg-white/90 backdrop-blur-xl":"bg-black/40 backdrop-blur-sm")}),(0,t.jsxs)(v.motion.div,{variants:T?{hidden:{y:"100%",opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:30,stiffness:300,mass:.8}},exit:{y:"100%",opacity:0,transition:{duration:.3,ease:"easeInOut"}}}:{hidden:{opacity:0,scale:.95,y:20},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",damping:20,stiffness:200}},exit:{opacity:0,scale:.95,y:20,transition:{duration:.2}}},initial:"hidden",animate:"visible",exit:"exit",className:$("relative z-50 w-full overflow-hidden",T?"h-screen flex flex-col justify-center px-6":"max-w-lg bg-white/80 backdrop-blur-2xl rounded-[2.5rem] shadow-2xl p-8 border border-white/40"),children:[!T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute -top-24 -left-24 w-64 h-64 bg-indigo-500/10 blur-[80px] rounded-full pointer-events-none"}),(0,t.jsx)("div",{className:"absolute -bottom-24 -right-24 w-64 h-64 bg-fuchsia-500/10 blur-[80px] rounded-full pointer-events-none"})]}),(0,t.jsx)("button",{onClick:a,className:$("absolute z-50 p-3 rounded-2xl bg-black/5 hover:bg-black/10 text-slate-600 transition-all active:scale-90",T?"top-6 right-6":"top-8 right-8"),"aria-label":"Close",children:(0,t.jsx)(w.X,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{className:"relative z-10 w-full max-w-sm mx-auto overflow-y-auto max-h-[90vh] no-scrollbar py-4",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)(v.motion.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"inline-flex items-center justify-center w-16 h-16 rounded-3xl bg-gradient-to-tr from-indigo-600 via-violet-600 to-fuchsia-600 mb-6 shadow-xl shadow-indigo-500/20",children:(0,t.jsx)(S.Sparkles,{className:"w-8 h-8 text-white"})}),(0,t.jsxs)("h2",{className:"text-4xl sm:text-5xl font-black text-slate-900 tracking-tight mb-3",children:["Welcome to ",(0,t.jsx)("span",{className:"text-indigo-600",children:"MROHAUNG"})]}),(0,t.jsx)("p",{className:"text-slate-500 text-lg font-medium",children:"login"===r?"Great to see you again!":"Join the premium community today"})]}),(0,t.jsx)(j.AnimatePresence,{mode:"wait",children:(0,t.jsxs)(v.motion.form,{layout:!0,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},onSubmit:_,className:"space-y-4",children:["register"===r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(o.User,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-indigo-600 transition-colors"}),(0,t.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"Full Name",className:"w-full pl-12 pr-4 py-4 bg-slate-100/50 border-2 border-transparent rounded-2xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white transition-all text-base font-semibold",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(U.Calendar,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-indigo-600 transition-colors"}),(0,t.jsx)("input",{type:"date",value:h,onChange:e=>p(e.target.value),className:"w-full pl-12 pr-4 py-4 bg-slate-100/50 border-2 border-transparent rounded-2xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white transition-all text-sm font-semibold",required:!0})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("select",{value:g,onChange:e=>y(e.target.value),className:"w-full px-4 py-4 bg-slate-100/50 border-2 border-transparent rounded-2xl text-slate-900 focus:outline-none focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white transition-all text-sm font-semibold appearance-none",required:!0,children:[(0,t.jsx)("option",{value:"male",children:"Male"}),(0,t.jsx)("option",{value:"female",children:"Female"}),(0,t.jsx)("option",{value:"other",children:"Other"})]})})]}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(M.Phone,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-indigo-600 transition-colors"}),(0,t.jsx)("input",{type:"tel",value:A,onChange:e=>E(e.target.value),placeholder:"Phone Number",className:"w-full pl-12 pr-4 py-4 bg-slate-100/50 border-2 border-transparent rounded-2xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white transition-all text-base font-semibold",required:!0})]})]}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(N.Mail,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-indigo-600 transition-colors"}),(0,t.jsx)("input",{type:"email",value:n,onChange:e=>c(e.target.value),placeholder:"Email Address",className:"w-full pl-12 pr-4 py-4 bg-slate-100/50 border-2 border-transparent rounded-2xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white transition-all text-base font-semibold",required:!0})]}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(k.Lock,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-indigo-600 transition-colors"}),(0,t.jsx)("input",{type:H?"text":"password",value:d,onChange:e=>u(e.target.value),placeholder:"Password",className:"w-full pl-12 pr-12 py-4 bg-slate-100/50 border-2 border-transparent rounded-2xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white transition-all text-base font-semibold",required:!0}),(0,t.jsx)("button",{type:"button",onClick:()=>I(!H),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors p-1",children:H?(0,t.jsx)(z,{className:"w-5 h-5"}):(0,t.jsx)(F.Eye,{className:"w-5 h-5"})})]}),R&&(0,t.jsx)(v.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 rounded-2xl bg-red-50 text-red-600 text-sm font-bold text-center border border-red-100",children:R}),(0,t.jsx)(v.motion.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:L,className:"w-full py-5 bg-gradient-to-r from-indigo-600 via-violet-600 to-indigo-700 text-white font-black rounded-2xl shadow-xl shadow-indigo-500/25 flex items-center justify-center gap-2 text-base uppercase tracking-wider transition-all disabled:opacity-70 mt-4",children:L?(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):(0,t.jsxs)(t.Fragment,{children:["login"===r?"Sign In Securely":"Create Identity",(0,t.jsx)(C.ArrowRight,{className:"w-5 h-5"})]})})]},r)}),(0,t.jsx)("div",{className:"mt-8 text-center",children:(0,t.jsx)("button",{onClick:()=>i("login"===r?"register":"login"),className:"text-slate-500 text-sm font-bold hover:text-indigo-600 transition-colors inline-flex items-center gap-1 group",children:"login"===r?(0,t.jsxs)(t.Fragment,{children:["Don't have an identity yet? ",(0,t.jsx)("span",{className:"text-indigo-600 group-hover:underline Decoration-2",children:"Register Now"})]}):(0,t.jsxs)(t.Fragment,{children:["Already a member? ",(0,t.jsx)("span",{className:"text-indigo-600 group-hover:underline decoration-2",children:"Sign In"})]})})})]})]})]})})}function P({children:e}){let v=(0,l.usePathname)();(0,l.useRouter)();let{user:j,logout:w,updateUser:N,isAuthModalOpen:k,closeAuthModal:S,authModalMode:C}=(0,b.useAuth)(),[M,U]=(0,s.useState)(!1),[F,z]=(0,s.useState)(!1),[A,E]=(0,s.useState)(!1),[$,P]=(0,s.useState)([]),[R,q]=(0,s.useState)(null),[H,I]=(0,s.useState)([]),[T,D]=(0,s.useState)(""),[O,_]=(0,s.useState)(null),[W,X]=(0,s.useState)(!1),[B,V]=(0,s.useState)(null),[G,K]=(0,s.useState)(!1);(0,s.useEffect)(()=>{j&&((async()=>{try{let e=await f.default.get("/messages/conversations?limit=5");P(e.data||[])}catch(e){console.error("Failed to fetch recent conversations:",e)}})(),(async()=>{try{await f.default.get("/admin/overview"),z(!0)}catch{z(!1)}})()),X(!0)},[j]),(0,s.useEffect)(()=>{(async()=>{let e=v?.split("/").filter(Boolean)||[],t=["login","register","admin","friends","messages","settings","terms","privacy","profile","api","_next"];if(2!==e.length||t.includes(e[0]))(0===e.length||t.includes(e[0]))&&G&&K(!1);else{let[t,s]=e;if(B?.id===s)return;try{let e=await f.default.get(`/posts/${s}`);e.data.author.username===t&&(V(e.data),K(!0))}catch(e){console.error("Deep link post fetch failed:",e)}}})()},[v,B?.id,G]);let J=(0,s.useMemo)(()=>{if(!W)return[];if(!j)return[{href:"/",label:"Feed",icon:r.Home}];let e=[{href:"/",label:"Home",icon:r.Home},{href:"/friends",label:"Friends",icon:n.Users},{href:j?`/profile/${j.username}`:"#",label:"Profile",icon:o.User}];return F&&e.push({href:"/admin",label:"Admin",icon:u.Shield}),e},[j,F,W]),Y=async e=>{q(e);try{let t=(await f.default.get("/messages/conversations")).data.find(t=>t.participants.some(t=>t.id===e.id));if(t){_(t.id);let e=await f.default.get(`/messages/conversations/${t.id}/messages`);I(e.data||[])}else _(null),I([])}catch(e){console.error("Failed to load chat:",e)}},Z=async e=>{if(e.preventDefault(),!T.trim()||!R)return;let t=T.trim();D("");try{let e=await f.default.post("/messages/send",{recipientId:R.id,content:t}),s=e.data.message||{id:Date.now().toString(),content:t,senderId:j?.id,createdAt:new Date().toISOString()};I(e=>[...e,s]),!O&&e.data.conversationId&&_(e.data.conversationId)}catch(e){console.error("Failed to send message:",e)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-[#0f172a] text-[#f8fafc]",children:[(0,t.jsx)("nav",{className:"fixed top-0 w-full z-[100] bg-[#0f172a]/80 backdrop-blur-md border-b border-[#1e293b]",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between",children:[(0,t.jsx)(a.default,{href:"/",className:"text-2xl font-black bg-gradient-to-r from-blue-500 to-purple-600 bg-clip-text text-transparent italic tracking-tighter",children:"MROHAUNG"}),(0,t.jsx)("div",{className:"hidden md:flex flex-1 mx-8 text-slate-800",children:(0,t.jsx)(m.default,{})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.default,{}),j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.default,{}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:()=>U(e=>!e),"aria-label":"Open user menu",className:"w-10 h-10 rounded-full border-2 border-[#1e293b] cursor-pointer hover:opacity-80 transition-opacity overflow-hidden",children:j.avatarUrl?(0,t.jsx)("img",{src:(0,g.fixUrl)(j.avatarUrl),alt:"",className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-tr from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold text-sm",children:(j.displayName||j.username)?.[0]?.toUpperCase()})}),M&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-[#1e293b] border border-[#334155] rounded-2xl shadow-xl overflow-hidden z-[60]",children:[(0,t.jsxs)(a.default,{href:`/profile/${j.username}`,className:"flex items-center gap-3 px-4 py-3 hover:bg-[#334155] transition-colors",onClick:()=>U(!1),children:[(0,t.jsx)(o.User,{className:"w-5 h-5 text-[#94a3b8]"}),(0,t.jsx)("span",{className:"text-white font-medium",children:"Profile"})]}),(0,t.jsxs)(a.default,{href:"/settings",className:"flex items-center gap-3 px-4 py-3 hover:bg-[#334155] transition-colors",onClick:()=>U(!1),children:[(0,t.jsx)(c.Settings,{className:"w-5 h-5 text-[#94a3b8]"}),(0,t.jsx)("span",{className:"text-white font-medium",children:"Settings"})]}),(0,t.jsx)("div",{className:"border-t border-[#334155]"}),(0,t.jsxs)("button",{onClick:()=>{w(),U(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-500/10 transition-colors text-left",children:[(0,t.jsx)(d.LogOut,{className:"w-5 h-5 text-red-500"}),(0,t.jsx)("span",{className:"text-red-500 font-medium",children:"Logout"})]})]})]})]}):(0,t.jsx)(a.default,{href:"/login",className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-xl text-sm font-bold transition-colors",children:"Login"})]})]})}),(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 pt-24 flex gap-8",children:[(0,t.jsxs)("aside",{className:"hidden lg:block w-64 h-fit sticky top-24",children:[(0,t.jsx)("ul",{className:"space-y-2",children:J.map(e=>{var s;let l=e.icon,r="/"===(s=e.href)?"/"===v:v?.startsWith(s);return(0,t.jsx)("li",{children:(0,t.jsxs)(a.default,{href:e.href,className:`w-full flex items-center gap-4 px-4 py-3 rounded-2xl transition-all ${r?"bg-blue-600/10 text-blue-500 font-bold":"text-[#94a3b8] hover:bg-[#1e293b] hover:text-white"}`,children:[(0,t.jsx)(l,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-base",children:e.label})]})},e.href)})}),j&&(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#334155]/50 relative",children:[(0,t.jsxs)("button",{onClick:()=>E(!A),className:`w-full flex items-center gap-4 px-4 py-3 rounded-2xl transition-all ${v?.startsWith("/messages")?"bg-blue-600/10 text-blue-500 font-bold":"text-[#94a3b8] hover:bg-[#1e293b] hover:text-white"}`,children:[(0,t.jsx)(i.MessageCircle,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-base flex-1 text-left",children:"Messages"}),(0,t.jsx)(x.ChevronUp,{className:`w-4 h-4 transition-transform ${A?"":"rotate-180"}`})]}),A&&(0,t.jsx)("div",{className:"mt-2 bg-[#1e293b] border border-[#334155] rounded-xl overflow-hidden",children:R?(0,t.jsxs)("div",{className:"flex flex-col h-80",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-[#334155]/50 bg-[#334155]/20",children:[(0,t.jsx)("button",{onClick:()=>q(null),className:"p-1 hover:bg-[#334155] rounded-lg text-[#94a3b8]",children:(0,t.jsx)(x.ChevronUp,{className:"w-4 h-4 rotate-[-90deg]"})}),(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-gradient-to-tr from-blue-600 via-purple-600 to-pink-600"}),(0,t.jsx)("span",{className:"text-sm font-medium text-white flex-1 truncate",children:R.displayName||R.username})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:0===H.length?(0,t.jsx)("div",{className:"h-full flex items-center justify-center text-xs text-[#64748b]",children:"Start a conversation..."}):H.map(e=>(0,t.jsx)("div",{className:`flex ${e.senderId===j?.id?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[80%] px-3 py-2 rounded-xl text-xs ${e.senderId===j?.id?"bg-blue-600 text-white rounded-br-none":"bg-[#334155] text-white rounded-bl-none"}`,children:[(0,t.jsx)("p",{children:e.content}),(0,t.jsx)("span",{className:"text-[9px] opacity-70 mt-1 block",children:new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e.id))}),(0,t.jsx)("form",{onSubmit:Z,className:"p-2 border-t border-[#334155]/50",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:T,onChange:e=>D(e.target.value),placeholder:"Type a message...",className:"flex-1 bg-[#334155]/50 border border-[#334155] rounded-lg px-3 py-2 text-sm text-white placeholder-[#64748b] focus:outline-none focus:border-blue-500"}),(0,t.jsx)("button",{type:"submit",disabled:!T.trim(),className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white text-sm font-medium transition-colors",children:"Send"})]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.default,{href:"/messages",className:"flex items-center gap-3 px-4 py-3 hover:bg-[#334155]/50 transition-colors text-sm text-[#94a3b8] hover:text-white border-b border-[#334155]/50",onClick:()=>E(!1),children:(0,t.jsx)("span",{children:"View All Messages"})}),$.length>0?$.map(e=>{let s=e.participants?.[0];return(0,t.jsxs)("button",{onClick:()=>Y(s),className:"w-full flex items-center gap-3 px-4 py-2.5 hover:bg-[#334155]/50 transition-colors text-left",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-tr from-blue-600 via-purple-600 to-pink-600 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-white truncate",children:s?.displayName||s?.username}),(0,t.jsx)("p",{className:"text-xs text-[#64748b] truncate",children:e.lastMessage?.content||"No messages yet"})]})]},e.id)}):(0,t.jsx)("div",{className:"px-4 py-3 text-xs text-[#64748b]",children:"No recent conversations"})]})})]})]}),(0,t.jsx)("main",{className:"flex-1 min-w-0",children:e})]}),(0,t.jsx)(L,{isOpen:k,onClose:S,initialMode:C}),B&&(0,t.jsx)(y.default,{isOpen:G,onClose:()=>K(!1),post:B,currentUserId:j?.id})]})}e.s(["default",()=>P],5469)}]);