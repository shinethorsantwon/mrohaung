(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78894,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},73708,e=>{"use strict";let t=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>t],73708)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},88653,e=>{"use strict";e.i(47167);var t=e.i(43476),s=e.i(71645),r=e.i(31178),l=e.i(47414),a=e.i(74008),o=e.i(21476),n=e.i(72846),i=s,d=e.i(37806);function c(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent&&!1!==this.props.pop){let e=t.offsetParent,s=(0,n.isHTMLElement)(e)&&e.offsetWidth||0,r=(0,n.isHTMLElement)(e)&&e.offsetHeight||0,l=this.props.sizeRef.current;l.height=t.offsetHeight||0,l.width=t.offsetWidth||0,l.top=t.offsetTop,l.left=t.offsetLeft,l.right=s-l.width-l.left,l.bottom=r-l.height-l.top}return null}componentDidUpdate(){}render(){return this.props.children}}function h({children:e,isPresent:r,anchorX:l,anchorY:a,root:o,pop:n}){let h=(0,i.useId)(),f=(0,i.useRef)(null),x=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:m}=(0,i.useContext)(d.MotionConfigContext),p=function(...e){return s.useCallback(function(...e){return t=>{let s=!1,r=e.map(e=>{let r=c(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():c(e[t],null)}}}}(...e),e)}(f,e.props?.ref??e?.ref);return(0,i.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:i,right:d,bottom:c}=x.current;if(r||!1===n||!f.current||!e||!t)return;let u="left"===l?`left: ${i}`:`right: ${d}`,p="bottom"===a?`bottom: ${c}`:`top: ${s}`;f.current.dataset.motionPopId=h;let b=document.createElement("style");m&&(b.nonce=m);let g=o??document.head;return g.appendChild(b),b.sheet&&b.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            ${p}px !important;
          }
        `),()=>{g.contains(b)&&g.removeChild(b)}},[r]),(0,t.jsx)(u,{isPresent:r,childRef:f,sizeRef:x,pop:n,children:!1===n?e:i.cloneElement(e,{ref:p})})}let f=({children:e,initial:r,isPresent:a,onExitComplete:n,custom:i,presenceAffectsLayout:d,mode:c,anchorX:u,anchorY:f,root:m})=>{let p=(0,l.useConstant)(x),b=(0,s.useId)(),g=!0,y=(0,s.useMemo)(()=>(g=!1,{id:b,initial:r,isPresent:a,custom:i,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;n&&n()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[a,p,n]);return d&&g&&(y={...y}),(0,s.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[a]),s.useEffect(()=>{a||p.size||!n||n()},[a]),e=(0,t.jsx)(h,{pop:"popLayout"===c,isPresent:a,anchorX:u,anchorY:f,root:m,children:e}),(0,t.jsx)(o.PresenceContext.Provider,{value:y,children:e})};function x(){return new Map}var m=e.i(64978);let p=e=>e.key||"";function b(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let g=({children:e,custom:o,initial:n=!0,onExitComplete:i,presenceAffectsLayout:d=!0,mode:c="sync",propagate:u=!1,anchorX:h="left",anchorY:x="top",root:g})=>{let[y,j]=(0,m.usePresence)(u),w=(0,s.useMemo)(()=>b(e),[e]),v=u&&!y?[]:w.map(p),N=(0,s.useRef)(!0),k=(0,s.useRef)(w),S=(0,l.useConstant)(()=>new Map),C=(0,s.useRef)(new Set),[U,M]=(0,s.useState)(w),[E,$]=(0,s.useState)(w);(0,a.useIsomorphicLayoutEffect)(()=>{N.current=!1,k.current=w;for(let e=0;e<E.length;e++){let t=p(E[e]);v.includes(t)?(S.delete(t),C.current.delete(t)):!0!==S.get(t)&&S.set(t,!1)}},[E,v.length,v.join("-")]);let I=[];if(w!==U){let e=[...w];for(let t=0;t<E.length;t++){let s=E[t],r=p(s);v.includes(r)||(e.splice(t,0,s),I.push(s))}return"wait"===c&&I.length&&(e=I),$(b(e)),M(w),null}let{forceRender:L}=(0,s.useContext)(r.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:E.map(e=>{let s=p(e),r=(!u||!!y)&&(w===E||v.includes(s));return(0,t.jsx)(f,{isPresent:r,initial:(!N.current||!!n)&&void 0,custom:o,presenceAffectsLayout:d,mode:c,root:g,onExitComplete:r?void 0:()=>{if(C.current.has(s)||(C.current.add(s),!S.has(s)))return;S.set(s,!0);let e=!0;S.forEach(t=>{t||(e=!1)}),e&&(L?.(),$(k.current),u&&j?.(),i&&i())},anchorX:h,anchorY:x,children:e},s)})})};e.s(["AnimatePresence",()=>g],88653)},97960,e=>{"use strict";let t=(0,e.i(75254).default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);e.s(["Smile",()=>t],97960)},48478,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(464),l=e.i(53e3),a=e.i(56011),o=e.i(75254);let n=(0,o.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var i=e.i(85384),d=e.i(37727),c=e.i(69074),u=e.i(13385);function h({onClose:e,onStoryCreated:r}){let[l,a]=(0,s.useState)("media"),[o,n]=(0,s.useState)(null),[h,f]=(0,s.useState)(null),[x,m]=(0,s.useState)(""),[p,b]=(0,s.useState)("bg-gradient-to-br from-blue-500 to-purple-600"),[g,y]=(0,s.useState)("font-sans"),[j,w]=(0,s.useState)(""),[v,N]=(0,s.useState)(!1),k=async e=>{let t=e.target.files?.[0];if(t)try{let e=await (0,u.default)(t,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,fileType:"image/jpeg"});n(e),f(URL.createObjectURL(e))}catch(e){console.error("Error compressing image:",e),n(t),f(URL.createObjectURL(t))}},S=async()=>{if("media"===l&&!o||"text"===l&&!x.trim())return;N(!0);let t=new FormData;"media"===l?(t.append("type","image"),o&&t.append("media",o),j&&t.append("content",j)):(t.append("type","text"),t.append("content",x),t.append("background",p),t.append("fontStyle",g));try{await i.default.post("/stories",t),r&&r(),e()}catch(e){console.error("Failed to create story:",e)}finally{N(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-[#1e293b] rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto border border-[#334155] shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-[#334155]",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-white",children:"Create Story"}),(0,t.jsx)("button",{onClick:e,className:"p-2 hover:bg-[#334155] rounded-full transition-colors",children:(0,t.jsx)(d.X,{className:"w-5 h-5 text-[#94a3b8]"})})]}),(0,t.jsxs)("div",{className:"flex border-b border-[#334155]",children:[(0,t.jsx)("button",{onClick:()=>a("media"),className:`flex-1 py-3 text-sm font-semibold transition-colors ${"media"===l?"text-blue-400 border-b-2 border-blue-400":"text-[#64748b] hover:text-[#94a3b8]"}`,children:"Photo / Video"}),(0,t.jsx)("button",{onClick:()=>a("text"),className:`flex-1 py-3 text-sm font-semibold transition-colors ${"text"===l?"text-blue-400 border-b-2 border-blue-400":"text-[#64748b] hover:text-[#94a3b8]"}`,children:"Text Story"})]}),(0,t.jsx)("div",{className:"p-6",children:"media"===l?(0,t.jsx)("div",{className:"space-y-4",children:h?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative rounded-xl overflow-hidden shadow-lg",children:[(0,t.jsx)("img",{src:h,alt:"Preview",className:"w-full h-80 object-cover"}),(0,t.jsx)("button",{onClick:()=>{n(null),f(null)},className:"absolute top-2 right-2 p-2 bg-black/60 rounded-full hover:bg-black/80 transition-colors",children:(0,t.jsx)(d.X,{className:"w-4 h-4 text-white"})})]}),(0,t.jsx)("input",{type:"text",value:j,onChange:e=>w(e.target.value),placeholder:"Add a caption...",className:"w-full bg-[#0f172a] border border-[#334155] rounded-xl text-white placeholder-[#64748b] px-4 py-3 focus:outline-none focus:border-blue-500"})]}):(0,t.jsxs)("label",{className:"flex flex-col items-center justify-center h-80 border-2 border-dashed border-[#334155] rounded-xl cursor-pointer hover:border-blue-500 transition-colors bg-[#0f172a]/50",children:[(0,t.jsx)(c.Upload,{className:"w-12 h-12 text-[#64748b] mb-4"}),(0,t.jsx)("p",{className:"text-[#94a3b8] font-medium",children:"Upload Image"}),(0,t.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:k})]})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:`w-full h-80 rounded-xl ${p} flex items-center justify-center p-8 text-center shadow-lg transition-all`,children:(0,t.jsx)("textarea",{value:x,onChange:e=>m(e.target.value),placeholder:"Type something...",className:`w-full h-full bg-transparent border-none outline-none text-white placeholder-white/50 text-2xl font-bold text-center resize-none ${g}`})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-[#64748b] uppercase tracking-wider mb-2 block",children:"Background"}),(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin",children:["bg-gradient-to-br from-blue-500 to-purple-600","bg-gradient-to-br from-pink-500 to-orange-400","bg-gradient-to-br from-indigo-500 to-cyan-400","bg-gradient-to-br from-green-400 to-blue-500","bg-gradient-to-br from-rose-500 to-red-600","bg-gradient-to-br from-slate-900 to-slate-700"].map((e,s)=>(0,t.jsx)("button",{onClick:()=>b(e),className:`w-10 h-10 rounded-full ${e} flex-shrink-0 ring-2 transition-all ${p===e?"ring-white scale-110":"ring-transparent hover:scale-105"}`},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-[#64748b] uppercase tracking-wider mb-2 block",children:"Font Style"}),(0,t.jsx)("div",{className:"flex gap-2",children:[{name:"Modern",class:"font-sans"},{name:"Elegant",class:"font-serif"},{name:"Code",class:"font-mono"}].map(e=>(0,t.jsx)("button",{onClick:()=>y(e.class),className:`px-3 py-1.5 rounded-lg text-sm transition-colors border ${g===e.class?"bg-[#334155] text-white border-blue-500":"bg-[#0f172a] text-[#94a3b8] border-[#334155] hover:bg-[#1e293b]"}`,children:e.name},e.name))})]})]})]})}),(0,t.jsxs)("div",{className:"p-4 border-t border-[#334155] flex gap-3 bg-[#0f172a]/50",children:[(0,t.jsx)("button",{onClick:e,className:"flex-1 px-4 py-2 bg-[#334155] hover:bg-[#475569] text-white rounded-xl font-medium transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:S,disabled:v||"media"===l&&!o||"text"===l&&!x.trim(),className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-xl font-medium transition-colors shadow-lg shadow-blue-500/20",children:v?"Posting...":"Share to Story"})]})]})})}let f=(0,o.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),x=(0,o.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),m=(0,o.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var p=e.i(27612);function b({storyGroup:e,allStoryGroups:r,onClose:l,onStoryChange:a}){let[o,n]=(0,s.useState)(0),[c,u]=(0,s.useState)(0),[h,b]=(0,s.useState)(!1),[g,y]=(0,s.useState)(null),j=e.stories[o],w=g?.id===e.userId;(0,s.useEffect)(()=>{let e=localStorage.getItem("user");e&&y(JSON.parse(e))},[]),(0,s.useEffect)(()=>{j&&!j.hasViewed&&i.default.post(`/stories/${j.id}/view`).catch(console.error)},[j]),(0,s.useEffect)(()=>{if(h)return;let e=setInterval(()=>{u(e=>e>=100?(v(),0):e+2)},100);return()=>clearInterval(e)},[o,h]);let v=()=>{if(o<e.stories.length-1)n(o+1),u(0);else{let t=r.findIndex(t=>t.userId===e.userId);t<r.length-1?(a(r[t+1]),n(0),u(0)):l()}},N=async()=>{if(w)try{await i.default.delete(`/stories/${j.id}`);let t=e.stories.filter(e=>e.id!==j.id);0===t.length?l():(e.stories=t,o>=t.length&&n(t.length-1))}catch(e){console.error("Failed to delete story:",e)}};return(0,t.jsxs)("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 flex gap-1 p-2 z-10",children:e.stories.map((e,s)=>(0,t.jsx)("div",{className:"flex-1 h-1 bg-white/30 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-white transition-all duration-100",style:{width:s<o?"100%":s===o?`${c}%`:"0%"}})},s))}),(0,t.jsxs)("div",{className:"absolute top-4 left-0 right-0 flex items-center justify-between px-4 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(w?g.avatarUrl:e.avatarUrl)?(0,t.jsx)("img",{src:w?g.avatarUrl:e.avatarUrl,alt:e.displayName||e.username||"",className:"w-10 h-10 rounded-full border-2 border-white object-cover"}):(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-blue-600 to-purple-600 border-2 border-white flex items-center justify-center text-white font-bold text-sm",children:(e.displayName||e.username)?.[0]?.toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white font-semibold",children:e.displayName||e.username}),(0,t.jsx)("p",{className:"text-white/70 text-sm",children:(e=>{let t=Math.floor((new Date().getTime()-new Date(e).getTime())/1e3);if(t<60)return`${t}s ago`;let s=Math.floor(t/60);if(s<60)return`${s}m ago`;let r=Math.floor(s/60);return`${r}h ago`})(j.createdAt)})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:N,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,t.jsx)(p.Trash2,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 bg-white/10 rounded-full",children:[(0,t.jsx)(m,{className:"w-4 h-4 text-white"}),(0,t.jsx)("span",{className:"text-white text-sm",children:j.viewCount})]})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,t.jsx)(d.X,{className:"w-6 h-6 text-white"})})]})]}),(0,t.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",onMouseDown:()=>b(!0),onMouseUp:()=>b(!1),onTouchStart:()=>b(!0),onTouchEnd:()=>b(!1),children:["text"===j.type?(0,t.jsx)("div",{className:`w-full h-full flex items-center justify-center p-12 ${j.background||"bg-gradient-to-br from-blue-500 to-purple-600"}`,children:(0,t.jsx)("p",{className:`text-white text-4xl font-bold text-center ${j.fontStyle||"font-sans"}`,children:j.content})}):(0,t.jsx)("img",{src:j.mediaUrl||j.imageUrl,alt:"Story",className:"max-w-full max-h-full object-contain"}),(0,t.jsx)("button",{onClick:()=>{if(o>0)n(o-1),u(0);else{let t=r.findIndex(t=>t.userId===e.userId);if(t>0){let e=r[t-1];a(e),n(e.stories.length-1),u(0)}}},className:"absolute left-0 top-0 bottom-0 w-1/3 flex items-center justify-start pl-4 hover:bg-gradient-to-r hover:from-black/20 transition-colors group",children:(0,t.jsx)(f,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),(0,t.jsx)("button",{onClick:v,className:"absolute right-0 top-0 bottom-0 w-1/3 flex items-center justify-end pr-4 hover:bg-gradient-to-l hover:from-black/20 transition-colors group",children:(0,t.jsx)(x,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}),"text"!==j.type&&j.content&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/60 to-transparent",children:(0,t.jsx)("p",{className:"text-white text-center text-lg",children:j.content})})]})}function g(){let[e,r]=(0,s.useState)([]),[l,a]=(0,s.useState)(!1),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("user");e&&u(JSON.parse(e))};return e(),f(),window.addEventListener("userUpdated",e),()=>window.removeEventListener("userUpdated",e)},[]);let f=async()=>{try{let e=await i.default.get("/stories");r(e.data)}catch(e){console.error("Failed to fetch stories:",e)}},x=e.find(e=>e.userId===c?.id);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-[#1e293b]/50 backdrop-blur-xl border border-[#334155] rounded-2xl p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex gap-4 overflow-x-auto pb-2 scrollbar-hide",children:[(0,t.jsxs)("button",{onClick:()=>a(!0),className:"flex-shrink-0 flex flex-col items-center gap-2 group",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-tr from-blue-600 to-purple-600 flex items-center justify-center",children:c?.avatarUrl?(0,t.jsx)("img",{src:c.avatarUrl,alt:"Your story",className:"w-14 h-14 rounded-full object-cover border border-[#1e293b]"}):(0,t.jsx)("div",{className:"w-14 h-14 rounded-full bg-[#334155] flex items-center justify-center border border-[#1e293b]",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:(c?.displayName||c?.username)?.[0]?.toUpperCase()||"+"})})}),(0,t.jsx)("div",{className:"absolute bottom-0 right-0 w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center border-2 border-[#1e293b]",children:(0,t.jsx)(n,{className:"w-3 h-3 text-white"})})]}),(0,t.jsx)("span",{className:"text-xs text-[#94a3b8] group-hover:text-white transition-colors",children:x?"Add Story":"Your Story"})]}),e.map(e=>(0,t.jsxs)("button",{onClick:()=>d(e),className:"flex-shrink-0 flex flex-col items-center gap-2 group",children:[(0,t.jsx)("div",{className:`w-16 h-16 rounded-full p-0.5 ${e.stories.some(e=>!e.hasViewed)?"bg-gradient-to-tr from-pink-500 via-purple-500 to-blue-500":"bg-[#334155]"}`,children:(e.userId===c?.id?c.avatarUrl:e.avatarUrl)?(0,t.jsx)("img",{src:e.userId===c?.id?c.avatarUrl:e.avatarUrl,alt:e.displayName||e.username||"",className:"w-full h-full rounded-full object-cover border-2 border-[#1e293b]"}):(0,t.jsx)("div",{className:"w-full h-full rounded-full bg-gradient-to-tr from-blue-600 to-purple-600 border-2 border-[#1e293b] flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-bold text-xs",children:(e.displayName||e.username)?.[0]?.toUpperCase()})})}),(0,t.jsx)("span",{className:"text-xs text-[#94a3b8] group-hover:text-white transition-colors max-w-[64px] truncate",children:e.userId===c?.id?"You":e.displayName||e.username})]},e.userId))]})}),l&&(0,t.jsx)(h,{onClose:()=>a(!1),onStoryCreated:()=>{f()}}),o&&(0,t.jsx)(b,{storyGroup:o,allStoryGroups:e,onClose:()=>d(null),onStoryChange:e=>d(e)})]})}var y=e.i(15377),j=e.i(5469),w=e.i(59796);function v(){let{user:e}=(0,w.useAuth)(),[o,n]=(0,s.useState)([]),[d,c]=(0,s.useState)(!0),[u,h]=(0,s.useState)(1),[f,x]=(0,s.useState)(!0),[m,p]=(0,s.useState)(!1),[b,v]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{let e=await i.default.get("/posts/feed?page=1&limit=10");n(e.data),x(10===e.data.length)}catch(e){console.error("Failed to fetch posts:",e)}finally{c(!1)}})()},[]),(0,s.useEffect)(()=>{let e=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.offsetHeight-100&&!m&&f&&S()};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[m,f,u]);let S=async()=>{p(!0);try{let e=u+1,t=await i.default.get(`/posts/feed?page=${e}&limit=10`);t.data.length>0?(n(e=>[...e,...t.data]),h(e),x(10===t.data.length)):x(!1)}catch(e){console.error("Failed to load more posts:",e)}finally{p(!1)}};return(0,t.jsxs)(j.default,{children:[e&&(0,t.jsx)(g,{}),(0,t.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-[minmax(0,1fr)_320px] gap-8",children:[(0,t.jsxs)("section",{className:"min-w-0",children:[e?(0,t.jsx)(r.default,{onPostCreated:async e=>{if(e){let t={...e,_count:{likes:0,comments:0},author:{...e.author,id:e.authorId}};n(e=>[t,...e])}else n((await i.default.get("/posts/feed?page=1&limit=10&_="+Date.now())).data)}}):(0,t.jsxs)("div",{className:"bg-[#1e293b]/50 border border-[#334155] rounded-2xl p-6 text-center mb-6",children:[(0,t.jsx)("h3",{className:"text-white font-bold text-lg mb-2",children:"Join the conversation"}),(0,t.jsx)("p",{className:"text-[#94a3b8] mb-4",children:"Sign in to share your thoughts and interact with others."}),(0,t.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,t.jsx)("a",{href:"/login",className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold transition-colors",children:"Login"}),(0,t.jsx)("a",{href:"/signup",className:"px-6 py-2 bg-[#334155] hover:bg-[#475569] text-white rounded-xl font-bold transition-colors",children:"Sign Up"})]})]}),d?(0,t.jsx)("div",{className:"space-y-6",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"bg-[#1e293b]/30 rounded-2xl h-64 animate-pulse"},e))}):(0,t.jsxs)("div",{className:"space-y-6",children:[o.map(s=>(0,t.jsx)(l.default,{post:s,isGuest:!e,onDelete:e=>{e?n(t=>t.filter(t=>t.id!==e)):i.default.get("/posts/feed?page=1&limit=10&_="+Date.now()).then(e=>n(e.data))},onUpdate:async()=>{n((await i.default.get("/posts/feed?page=1&limit=10&_="+Date.now())).data)},onEdit:e=>{v(e),k(!0)},onViewComments:t=>{e&&(v(t),k(!0))}},s.id)),0===o.length&&(0,t.jsx)("div",{className:"text-center py-20 bg-[#1e293b]/20 rounded-3xl border border-dashed border-[#334155]",children:(0,t.jsx)("p",{className:"text-[#64748b]",children:"No posts yet."})}),m&&(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),!f&&o.length>0&&(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-[#64748b] text-sm",children:"You've reached the end"})})]})]}),(0,t.jsx)("aside",{className:"hidden xl:block",children:(0,t.jsx)("div",{className:"sticky top-24 space-y-4",children:e&&(0,t.jsx)(y.default,{})})})]}),b&&(0,t.jsx)(a.default,{isOpen:N,onClose:()=>{k(!1),v(null)},post:b,onUpdate:async()=>{n((await i.default.get("/posts/feed?page=1&limit=10&_="+Date.now())).data)},onDelete:async()=>{n((await i.default.get("/posts/feed?page=1&limit=10&_="+Date.now())).data)},currentUserId:e?.id})]})}e.s(["default",()=>v],48478)}]);